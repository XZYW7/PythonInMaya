## Generating Spatial Distributions for Multilevel Models of Plant Communities

通过www.DeepL.com/Translator（免费版）翻译

### 摘要Abstract

大范围植物的模拟和可视化有很多应用。使用多级模型可以捕捉到结果场景的极端视觉复杂性。

例如在两级模型中，植物分布可以用粗（coarse）植物模型表示，然后真实感的可视化通过用详细的植物模型代替粗植物模型来获得。

在这篇文章中，我们聚焦于粗模型。并且考虑两类模型：局部-全局模型，基于个体的生态系统模拟；相反的有全局-局部模型，个体植物的位置由给定的植物密度分布来推断。我们将之前使用这两类模型获得的结果与其他现象进行了扩展，包括植物的聚集和演替。我们也引入了多集multiset L system来形成基于个体的模拟模型。

### 1. Introduction

植物生态系统的模拟和可视化有许多理论和实际上的应用。包括生态学的基础研究、林业实践的视觉影响分析和计算机动画的复杂场景合成等。生态系统模拟产生的场景的固有复杂性，可以使用多层次建模来管理。多级方法使用了一系列模型，而不是建模整个生态系统的植物器官的细节层级，（如叶子、花、顶端和节间）。例如，在最简单的两级情况下，高级模型确定植物的分布，低级模型确定植物的形状。模型是耦合的，因此在较高级别创建的信息可以影响较低级别模型的结果。

 在本文中，我们重点研究了植物空间分布的生成。具体来说，我们将[3]中报告的方法扩展为具有生态学和视觉重要性的植物聚类和演替现象。 我们还引入了多集L-系统的形式化来形式化其中一些模型。第2节总结了以前关于植物生态系统多层次建模的工作。按照那里介绍的方法，我们区分了从局部到整体的方法和从整体到局部的方法，前者是通过模拟单个植物之间的相互作用来确定植物密度的分布，后者则是通过给定的大规模密度分布来推断单个植物的位置。在第3.1节中，我们介绍了多集L-系统，作为L-系统建模框架的一个扩展。这一扩展使我们能够使用L-系统（长期以来是一种单独的植物建模范式）来表达生成植物分布的局部到整体的算法。第3.2至3.4节给出了多集L-系统的应用实例。第4节介绍了植物分布的全局到局部建模的概念和实例，它扩展了[7]中报告的初步结果。第5节给出了结论。

### 2. Previous work

用于图像合成的植物群落多级建模是在[3]中提出的，尽管相关的技术在更早的时候就已经使用，例如[1]。其主要概念是将植物生态系统的生成视为一个层次的任务：指定地形，使用粗略的植物模型生成植物分布，根据需要合成详细的植物模型以填充场景，并使用这些详细模型的实例渲染最终场景。
[3]中使用了两种不同的方法来创建植物分布。第一种是基于个体的生态系统模拟，基于Firbank和Watkinson的模型[4]。按照该模型，模拟的植物被随机放置在田间，然后反复 "生长"，当被较大的植物支配时就 "杀死"。由此产生的分布符合植物生态学的自我消减曲线[8]，这是相同年龄的植物单株栽培中的平均质量和平均密度之间的关系。基于个体的方法也被用于[3]，以产生植物大小的层次（分布）（参看[8]），类似于在自然界观察到的情况。
 第二种方法是为了让用户在定义植物的局部密度时有更多的控制。输入是一个灰度图像，代表整个田野的植物密度图。Floyd-Steinberg误差扩散算法[5]被用来创建符合这些密度的单个植物的位置。该算法产生的点被稍微抖动了一下，以使分布看起来更加随机。
这两种方法体现了生态建模的两种不同方法。基于个体的模拟是局部到全球方法的代表。它的特点是，从单个植物的局部相互作用中出现全局特征。相比之下，误差扩散法是反向的、从全球到地方的方法的一个例子，其中局部特征来自分布的全球属性。这种区别类似于用于单个植物建模的从局部到全局和从全局到局部的方法[14]。
[3]中描述的方法倾向于创建统一的植物分布。然而，在现实中，植物往往是聚类的。聚集，也被称为结块或分散不足[2]，是一种常见的现象，由环境因素（同一类型的植物倾向于聚集在对其生长有利的区域）、繁殖（种子落在其母株附近，或植物通过匐茎繁殖）以及其他机制引起。它对植物分布的外观有很大的影响，这就是为什么我们要寻求它的模型。
聚集的影响可以用几种统计方法来量化。我们使用霍普金斯指数[6]，它被定义为在给定区域内从随机选择的点到其最近的植物的平均距离，除以从随机选择的植物到其最近的植物的平均距离。
$$
H = \frac{<\min_i(||x-p_i||)>_x}{<\min(||p_j-p_i||)>_j}
$$


完全不相关的分布（"随机"）的H值为1。比随机更分散的分布（"规则"）的H值小于1，而聚类的分布的H值大于1。例如，图1比较了霍普金斯指数为0.4的过度分散的分布和霍普金斯指数为2.4的聚类分布。

### 3.Local-to-global modeling of plant distribution局部到全局的植物分布模型

#### 3.1Multiset L-systems多集Lsystem

我们使用L-系统[13]和基于Chomsky语法的相关技术[14]为单个植物建模。我们使用L-系统[13]和基于乔姆斯基语法的相关技术[14]为单个植物建模。此外，我们扩展了L系统的形式主义，使用从局部到整体的方法生成植物的分布。为此，我们引入了多集L-系统的概念。
L-系统模型生成的植物以符号串[9]和可选参数[13]表示。这些符号串定义了所生成结构的拓扑结构和几何结构。一个L系统的规范由三个部分组成：字母表，它是代表植物不同组成部分的符号集；公理，它代表了模型结构的初始状态；以及一个列表，它代表了植物的结构。模型结构的初始状态；以及一个生产列表，它定义了工厂组件在不同时间段的发展。字母表可以隐含地定义为出现在产品中的符号集。一个工厂的发展是以一连串的衍生步骤来模拟的。在任何一个步骤中，每个符号都使用列表中第一个适用的生成物进行改写（如果没有生成物，则改写为自身），产生一个新的字符串。L-系统的一个扩展被称为伪L-系统[11]，它可以用一个生产来重写两个或多个符号。另一个扩展，称为开放L-系统[10]，使得捕捉建模植物和它们的环境之间的相互作用成为可能。
多集L-系统统一并扩展到L-系统理论的两个先前定义的概念：具有有限公理集的发展系统[16]和具有分割的L-系统[17]。在多集L系统中，生产集对代表许多植物的多集字符串进行操作，而不是代表单个植物的单一字符串。新的字符串可以动态地加入或从这个多集中删除，代表被加入或从种群中删除的生物。

形式上，一个无上下文的非参数多集L系统是一个四元组G=〈V，%，Ω，P〉，其中V是字母表（一个有限的符号集），% 6∈V是一个保留的分割符号，Ω⊂V ? 是V上的一个有限的词集，称为公理，P⊂V×（V∪{%}）? 是一个有限的生产集合。字母表V可以包含，特别是一对大括号，[ 和 ]，在树结构的括号字符串符号中，这些括号被用来给分支划界[13]。
多集L系统的推导步骤由两个子步骤组成。首先，前任多集合中的所有词xi被中间的后继词yi替换，使用P中的产物。 单独的派生xi → yi是在普通的L系统中进行的。其次，包含一个或多个片段符号%的词yi被细分。在这个过程中，符号%作为标记，标志着分支yik从树yi上被切断的位置。树的剩余部分yi和被切断的分支 yik成为后续多集的成员

L系统的扩展，如伪L系统和开放L系统，也适用于多集L系统。特别是，在生态系统的模拟中，我们广泛地依赖通信符号，在[10]中作为开放L系统形式主义的一部分引入。通信符号是植物模型与环境之间信息交流的载体。它可以与一个或多个参数相关联，这些参数由与基于L系统的模拟器连接的环境程序设置。生态系统模拟中使用的植物模型是极其简化的，以适应大量的植物。我们使用了基于L系统的植物建模软件L-studio/cpfg[12]，该软件扩展了多组功能，既能生成植物分布，又能对单个植物进行建模

#### 3.2 Self-thinning

作为上述概念的第一个说明，让我们考虑在[3]中概述的基于个体的自我修剪模型的多集L系统的实现。自我瘦身发生在一群同种同龄的植物之间。随着植物的生长和对资源的竞争，较小和较弱的植物会被较大和较强的植物所支配，并最终死亡。这个过程的本质可以用图2所示的一组规则来捕捉。下面给出了相应的L系统

每个植物由模块T(~x,r)描述，然后是通信模块E(c)。矢量~x和数字r代表植物的位置和大小（芽半径）。参数c用于与环境过程的通信，如果植物没有被支配，环境过程将c设置为1，如果被支配则设置为0。环境过程将每个植物视为一个半径为r的圆，并确定哪些圆是相交的。任何一对相交的圆中较小的圆被认为是被支配的。

![image-20220708200929498](Generating%20Spatial%20Distributions/image-20220708200929498.png)

该公理引入了n个具有随机位置和大小的植物（植物的初始分布也可以通过算法产生）。第一个生产，在条件c == 0的保护下，将任何被支配的植物和其相关的通信模块从种群中移除。生产2停止已经达到最大尺寸R的植物的生长。最后，生产3增加既不被支配也不成熟的植物的尺寸。用户定义的函数grow(r, ∆t)捕捉了
半径为r的植物在时间间隔∆t内的生长。

图3显示了用这个L系统模拟的自我变细过程的三个阶段。随着植物群落的发展，占主导地位的植物逐渐消失，使分布变薄。用现实的植物模型代替各个圆圈得到的可视化样本显示在[3]。

#### 3.3 Plant succession

对以前的L系统进行扩展，将其转变为 两个植物物种之间的互动模型

![image-20220708203011378](Generating%20Spatial%20Distributions/image-20220708203011378.png)

在这个模型中，植物由模块T(~x,r,sp)表示。参数~x和r表示植物的位置和半径，和上一个模型一样。参数sp是植物的物种标识符，可以是1或2。p1在种群中增加了n个物种1的新植物和m个物种2的新植物。生产的前身X重新出现在继任者多组中，因此在每个模拟步骤中都有新的植物加入。p2和p3以1-shaded[sp]1的概率移除一个被支配的植物。shaded[sp]这个值被称为植物的耐荫性，是衡量它在阴影中生存的可能性的一个标准。
p4和5对植物的衰老进行建模。
一旦植物达到半径R，它就会以概率oldage[sp]存活；不能存活的植物就会死亡，并被从社区中移除。p6使用生长函数grow(r,sp,∆t)来模拟既不被支配也不衰老的植物的生长，根据其大小和种类。
在正确的参数化下，这个模型可以捕捉到继承的现象[8]。如果物种1比物种2有更高的生长速度，但耐荫性和老龄化存活率较低（grow(r,1Δt) > grow(r,2,Δt), shaded[1] < shaded[2], oldage[1] < oldage[2]），那么最初的空场将分阶段被填充。首先，该领域将被物种1所支配。随着物种1的最大成员的死亡，物种2的较小成员，由于其更大的耐荫性而存活下来，现在有了一个新的成员。
由于物种2的耐荫性更强，现在比物种1的幼苗有尺寸优势，它们将填补空白。
最终，该领域将由物种2的成员所主导。图2中显示了这一模型对三种植物物种的直接扩展。

#### 3.4 Plant propagation

对图3所示分布的霍普金斯指数进行评估，得出的H值分别等于0.8、0.4和0.4。同样，对图4中的分布进行霍普金斯指数评估，得出的H值为0.6、0.7、0.7和0.6。这表明，对空间的竞争导致了植物分布的过度分散。
我们可以看到为什么会出现这种情况。如果任何两种植物只要相互接触，其中一种就会成为主导。在我们的自我稀释模型中，被支配的植物会立即死亡；在继承模型中，它在每个衍生步骤中以某种概率死亡。在任何一种情况下，对空间的竞争都会促使植物分开，没有相反的机制鼓励植物聚集。
在自然界观察到的一种聚类机制是局部传播。例如，我们可以通过在同一物种的母株附近 "播种 "新的植物，而不是让它们在整个田地里随机出现来捕捉它。由此产生的演替模型的变化如下所示

![image-20220708210418585](Generating%20Spatial%20Distributions/image-20220708210418585.png)

该公理定义了模型的初始状态，即在田间随机放置n个物种1的植物和m个物种2的植物。随后的生产与继承模型中的生产相同，但生产5除外。根据它，一个没有被支配的植物在位置~x+∆~x处创造一个新的植物，其中∆~x是一个小的随机向量。由于新的植物与它的父本很接近，这种传播机制鼓励分布中的聚类

图5说明了这个模型的运作。开始时，植物是随机分布的。随着生态系统的发展，两个物种在空间上变得隔离，形成了每个物种的大型植物集群。例如，在所示的三个阶段，物种1的霍普金斯指数分别等于1.1、4.2和11。

### 4.Global-to-local modeling of plant communities全局到局部的植物群体

#### 4.1 The deformation-kernel method变形核法

图6显示了自瘦模型（第3.2节）中的一株植物对附近发现另一株植物的概率的影响。在参考植物半径rt内，发现另一株植物的概率非常小；在该半径之外，概率不受参考植物的影响。
图6中所示的函数K是变形核的一个例子。如果我们假设有一个表征在不同位置放置新植物的概率的值域，那么变形核就能捕捉到现有植物对这个值域的影响。植物之间的各种相互作用可以用不同形状的变形核来描述，如图7所示。
现在可以利用这个变形核的想法开发一个简单的植物安置算法。我们保持一个联合概率密度函数[15]f（x，y），它描述了在以点（x，y）为中心的区域dxdy放置新植物的概率f（x，y）dxdy。植物是一次放置一个；当每个植物被放置时，它的变形核会修改概率函数f。以这种方式，最终将形成一个植物的分布。

从形式上看，联合密度函数f定义了一个概率场，其中新植物生长在矩形[0，xs]×[0，ys]中的概率，0≤xs≤xmax，0≤ys≤ymax，由累积概率分布函数给出。

![image-20220708212847057](Generating%20Spatial%20Distributions/image-20220708212847057.png)

我们通过首先计算其y坐标，然后计算其x坐标，找到要添加的植物的位置（xt, yt）。为此，给定二维密度函数f（x，y），我们创建边际分布函数FY（ys）。该分布函数描述了yt≤ys的概率，与xt的选择无关。

![image-20220708213032063](Generating%20Spatial%20Distributions/image-20220708213032063.png)

我们使用逆变换方法[15]选择植物的yt坐标。为此，我们从[0, 1]上的均匀分布中产生一个随机数u。然后，我们对FY（y）进行二分搜索，以找到使FY（yt）=u的值yt。这就是我们工厂的y坐标。
一旦我们选择了yt，我们就计算条件分布FX|Y (xs | yt)，它描述了在一个给定的y值yt下xt≤xs的概率。

![image-20220708213341529](Generating%20Spatial%20Distributions/image-20220708213341529.png)

然后我们应用反变换的方法来寻找 坐标xt，给定FX|Y (xs | yt)

在位置（xt, yt）放置了一个大小为rt的植物后，我们现在对概率密度函数f（x, y）进行变形，以模拟该植物对附近植物放置的影响。为此，我们首先将概率密度函数f（x，y）乘以该植物的变形核K（x，y）。

![image-20220708213439513](Generating%20Spatial%20Distributions/image-20220708213439513.png)

然后将函数ftemp(x, y)重新规范化，以满足公式1。变形核通常是一个函数，其形式为

![image-20220708213640848](Generating%20Spatial%20Distributions/image-20220708213640848.png)

其中函数κ(r)衡量一个单位大小的植物对离它有一定距离的植物形成的影响。
实现上述概念的一个明显方法是用一个n乘n的样本阵列fij来表示概率密度函数f（x，y）的值。为了计算一个新植物的位置，我们创建一个行的部分和的向量R，其中

![image-20220708213747980](Generating%20Spatial%20Distributions/image-20220708213747980.png)

我们用反变换的方法确定新放置的植物的坐标yt。为此，我们从区间[0, Rn-1]上的均匀分布中挑选一个随机数u，然后进行二进制搜索，找到Ri，使Ri≤u < Ri+1。然后我们在(i, Ri)和(i+1, Ri+1)之间进行线性内插，以找到(yt, u)。
现在，一个代表条件分布的数值向量C 分布FX|Y (xs | yt)，通过插值计算出 阵列fij的第i行和第i+1行。

![image-20220708213900805](Generating%20Spatial%20Distributions/image-20220708213900805.png)

给出Ck值，k=0，1，...，n-1。, n - 1，我们从区间[0, Cn-1]上的均匀随机分布中选择一个值，并使用反变换方法来寻找xt。
核心的应用是简单地计算每个采样点（i，j）与（xt，yt）的距离d，然后将该点的分布函数f的值fij乘以κ( d/rt )。
如果有m个植物要放置，函数f用n2个值fij表示，上述算法将需要O(mn2)时间运行，因为每次放置一个新的植物时必须重新计算和Rk。我们通过增量更新阵列R来改进这一结果。当核被应用于分布时，fij和κ( d/rt )fij之间的差异被相加，每个
(i, j)的范围内进行求和，并将这些差值应用于R阵列。假设内核只应用于一小部分的植物，那么就可以将其应用到阵列R中。假设内核只应用于网格中的一小部分单元，这个 操作可以在每个植物的O(n)时间内完成。



图8说明了内核方法的操作。变形核是图7d的变形核。初始分布是均匀的；f (x, y) = c. 在中间，有一株植物被添加到田间；密度函数在该植物的附近被改变。在底部，又增加了四棵植物；密度函数在每棵植物附近都被修改了。
图9显示了使用该算法生成的具有不同变形核的点图案。这些图案的霍普金斯指数分别为0.4、1.0、1.2和2.4，证实了视觉上的观察，即内核方法能够创造一系列的分布，从过度分散到随机和聚类。
在图10中，点已经被使用L系统创建的简单的雏菊模型所取代。图10顶部的过度分散模式看起来没有底部的聚类模式那么真实，这证明了将聚类引入模型的合理性。

图10中所示的分布是在将概率密度函数f初始化为一个常数后生成的。相反，如果我们将f初始化为一个用户定义的场（例如用paint程序），我们可以生成符合这个场的植物空间分布，如图11所示。
这一结果改进了[3]中描述的方法，该方法允许应用用户指定的密度图，但不可能使其 控制植物聚类的程度。

#### 4.2 Extensions

基于内核的方法可以扩展到包括植物的大小信息，以及对几个物种的互动进行建模。
尺寸信息被考虑在内，按照尺寸大小的顺序放置植物，最大的先放。较大的、较老的植物会影响较小的、较年轻的植物的定位，这也是可以预期的。实际尺寸可能来自于这样的分布：大型植物少，中型植物多，小型植物也多。
种类1的植物对种类1的其他植物的影响可能与对种类2的植物的影响不同。
因此需要不同的内核来捕捉这些影响。事实上，对于两个物种，总共需要四个内核：一个是物种1对其自身的影响，一个是物种1对物种2的影响，一个是物种2对物种1的影响，还有一个是物种2对其自身的影响。在一般情况下，这导致了一个内核矩阵M（图12），它定义了每个物种对其自身和对其他物种的影响。
在将内核安置方法扩展到n个物种时，我们要跟踪n个不同的概率密度函数fi。当植物被放置时，每个概率密度函数被相关的核所变形；因此，如果一个物种j的植物被放置，每个函数fi被核Mi,j所变形，其中i=1，2，...，n。这个过程如图13所示。
图14展示了上述方法的一个应用实例。在这个场景中纳入的树的建模在[14]中讨论过。

### 5.Conclusions

我们对最初在[3]中提出的定义植物分布的方法进行了形式化和扩展。为此，我们引入了多集L-系统，这是L-系统形式主义的延伸，用来模拟植物群，而不是单独的单一植物。然后，我们应用这些L系统来模拟生态系统中植物的自我稀释、继承和集群的本质。
我们还改进了生成植物分布的交互技术，使之不仅可以指定全局密度，还可以指定聚类的水平。由此产生的核形变方法可以产生具有广泛聚类值的植物分布，从过度分散到随机到高度聚类。我们用几个植物群落的模型说明了这种方法的使用。
这两种方法都使其有可能以实际应用于现实图像合成所需的速度生成植物生态系统。表2中给出了与本文所包括的场景有关的统计数据。
我们相信，所提出的方法可以应用于不同的植物生态系统模型，并有各种实际应用，如用于计算机动画的场景修饰 场景的修饰，以及树木砍伐和再生对景观的视觉影响分析。景观上的树木砍伐和重新生长的视觉影响分析。场景的真实性 所产生的场景的真实性可以通过使用更精确的基础生物过程模型来进一步改善 础生物过程的更精确的模型，可以进一步提高所产生的场景的真实性。
和更复杂的渲染方法。