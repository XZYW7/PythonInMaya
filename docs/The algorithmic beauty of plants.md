## Chapter2

分支模式的计算机模拟有相对较长的历史。细胞空间模型第一个模型是由Ulam[149]提出的，（也见[138，第127-131页]），采用了von Neumann和Ulam[156]早先提出的细胞自动机概念。分支模式是迭代创建的，从一个三角形网格中的单个彩色单元开始，然后给触及前一个迭代步骤中被着色的单元的一个且仅有一个顶点的单元着色。
这一基本思想引起了一些扩展。Meinhardt[97，第15章]用正方形网格代替了三角形网格，并利用所得到的细胞空间来研究与网状结构的形成有关的生物假设。除了纯粹的分支模式外，他的模型还捕捉到可能发生在叶脉之间的分支重联或吻合的效果。Greene[54]将细胞自动机扩展到三维空间，并将得到的体素空间自动机应用于模拟对环境有反应的生长过程。例如，图2.1展示了房屋上的藤蔓的生长。
Cohen[15]用连续的泛化规则模拟了一个分支模式的发展。
在连续的 "密度场 "中而不是在离散的细胞或体素空间中运行的pansion规则来模拟分支模式的发展。这些方法的共同特点是强调生长结构的各种元素之间的相互作用，以及结构和环境之间的相互作用。尽管相互作用明显地影响了真实植物的发育，但它们也增加了模型的复杂性。这可能解释了为什么到目前为止比较简单的模型，甚至忽略了诸如树枝之间的碰撞这样的基本因素，一直很盛行。这一类的第一个模型是由Honda[65]提出的，Honda的模型用以下假设研究了树木的形态（图2.2）。

-   树段是直的，其周长不被考虑
-   一个母段通过一个分支过程产生两个子段。
-   相对于母段，两个子段的长度以恒定的比率r1和r2缩短。
-   母段和它的两个子段都包含在同一个分支平面内。子段相对于母分支形成恒定的分支角a1和a2。
-   枝条平面相对于重力方向是固定的，以便最接近水平面。
    以便最接近于一个水平面。附在主干上的枝条是个例外。在这种情况下，连续发出的侧枝段之间保持恒定的发散角α（参见第四章）。

通过改变数值参数，本田获得了各种各样的树状形状。经过一些改进[38]，他的模型被应用于研究真实树木的分支模式[39, 66, 67, 68]。随后，人们提出了不同的分支角度规则，以捕捉树的结构，其中连续分叉的平面是 互相垂直[69]。本田的研究结果是Aono提出的树模型的基础。Aono和Kunii提出的树模型[2]。他们对他的模型提出了几个扩展，其中最重要的是 枝条位置在一个特定的方向上的偏差，用于产生 风、向光性和重力的影响。一个类似的概念是 类似的概念以前由Cohen[15]提出，而更精确的基于物理的 而更精确的基于物理的枝条弯曲方法是由de Reffye[28]和Armstrong[4]开发的。

本田、青野和国井的模型是用宽度不变或变化的现实主义直线来表示 "树的骨架"。Bloomenthal[11]和Oppenheimer[105]在合成图像的真实性方面取得了重大改进，他们引入了弯曲的树枝，仔细建模的分支点周围的表面，以及纹理的树皮和树叶（图2.3）。
源于本田的工作的方法使用确定性算法定义了分支的随机模型结构。相比之下，随机机制是Reeves和Blau[119]、de Reeves和Blau[119]提出的树模型组的关键。Blau[119]、de Reffye等人[30]以及Remphrey、Neal和Steeves[120]提出的一组树模型，随机机制是必不可少的。 尽管这些模型使用不同的术语进行描述，但它们有一个共同的基本范式，即用形成分支的概率来指定树结构。Reeves和Blau的工作旨在产生类似树的形状，而没有深入研究模型结构的生物学细节（图2.4）。相反，de Reffye等人[29]采用随机方法，通过对离散时间间隔的芽的活动进行建模，模拟de Reffyereal植物的方法的发展。给定一个时钟信号，一个芽可以是

-   什么都不做。

- 成为一朵花。
- 变成一个节间，由一个新的直的顶点和一个或多个侧尖终止，由叶子支撑。
或更多的侧尖被叶子包住，或
- 死亡和消失。

这些事件是根据每个品种和每个物种特有的随机规律发生的。几何参数，如节间长度和直径，以及分枝角度，也是根据随机规律计算的。
纳入该方法的基本类型的发育规则对应于Hall ́e、Oldeman和Tomlinson[58]确定的23种不同类型的树木结构。所选植物物种的详细模型已经开发出来，并在文献中有所描述[16, 20, 26, 27, 76]。图2.5显示了一个树形模型的样本。Remphrey[120, 121, 122]的方法与de Reffye的方法类似，只是使用了较大的时间步长（在[120]中描述的熊果树模型中为一年）。因此，随机规则必须描述在一年期间可以形成的整个侧枝配置。

Aono和Kunii[2]首次考虑将L-系统应用于植物学树木的生成。他们参考了L-系统的原始定义[82]，发现它们不适合为高等植物的复杂分支模式建模。然而，他们的论点并没有延伸到具有海龟解释的参数化L-系统。例如，图2.6中的L系统实现了Honda[65]的那些树模型，其中一个分枝角等于0，产生了一个具有明确划分的主轴和侧轴的单枝结构
(见第3.2节的正式描述)。

![image-20220710141713076](The%20algorithmic%20beauty%20of%20plants/image-20220710141713076.png)

根据生产p1，主轴的顶点A在每个派生步骤中产生Monopodial branchingan internode F和一个侧向顶点B。常数r1和r2规定了直段和侧段的收缩率，a0和a2是分枝角，d是发散角。
模块!(w)将线宽设定为w，因此生产p1将子段的宽度相对于母段的宽度减少了wr=0.707的系数。这个常数满足了达芬奇的一个假设[95，第156页]，根据这个假设，"一棵树的所有枝条在其高度的每个阶段放在一起时，其厚度与它们下面的树干相等"。在一个直径为w1的母枝产生两个直径为w2的子枝的情况下，这个定理产生了方程w1^2 = 2w2^2，这使得wr的值等于w2/w1 = 1/√2 ≈ 0.707。Macdonald[94，第131-135页]一书中对母枝和子枝的直径关系进行了一般性讨论。
产物p2和p3描述了侧枝的后续发展。在每个派生步骤中，直顶（B或C）以相对于母轴的角度a2或-a2发出一个下一阶的侧向顶。采用两种制作方法，交替向左和向右创造侧尖。符号\$将乌龟的方向绕其自身轴线滚动，使指向乌龟左侧的矢量L（1.5节）被带到一个水平位置。因此，按照本田模型的要求，分支平面是 "最接近水平面的"。从技术角度看，$根据公式修改乌龟在空间的方向

![image-20220710141738369](The%20algorithmic%20beauty%20of%20plants/image-20220710141738369.png)



![image-20220710141951579](The%20algorithmic%20beauty%20of%20plants/image-20220710141951579.png)

 图2.7中规定了一个稍有不同的L系统，它捕捉了sym-Sympodial分支的荚膜结构，其中两个子节与母节形成非零角度。在这种情况下，主尖的活动被减少到形成主干F和一对侧尖B（生产p1）。随后的分支模式被生产p2所捕获。图2.7中的样本结构是用表2.2中所列的常数得到的，并与Aono和Kunii提出的模型相对应。

到目前为止所考虑的L系统的设计方式强调了它们与文献中描述的模型的关系。具体来说，所有的段在创建时都被分配了最终的长度，并且没有进一步的伸长发生。正如第1.10.3节所指出的，类似的结构可以通过创建恒定长度的新段和在每个推导步骤中以恒定系数增加以前创建的段的长度来获得。图2.8给出了一个按照这种模式构建的L系统样本。
该树的整体结构由生产p1定义。在每个派生步骤中，顶点A产生三个新的分支，由它们自己的顶点终止。参数w和常数vr将母枝w1的宽度与子枝w2的宽度联系起来。根据达芬奇的假设w21=3w22，因此vr=w1/w2=√3≈1.732。产物p2和p3捕捉到枝条的逐渐伸长和它们的直径随时间的推移而增加。
树枝的弯曲是通过在画完每一节后将乌龟向预定的倾向性矢量T的方向轻微旋转来模拟的（图2.9）。方向调整α是用公式α=e |H × T |来计算的，其中e是一个捕捉轴的易弯曲性的参数。这个启发式的公式有一个物理上的动机；如果T被解释为施加在矢量H的端点上的力，而H可以围绕其起点旋转，那么扭矩就等于H×T。与图2.8中树状结构的生成有关的参数列于表2.3。图2.10展示了图2.8d中树的更真实的渲染。

![image-20220710142539737](The%20algorithmic%20beauty%20of%20plants/image-20220710142539737.png)

![image-20220710142546975](The%20algorithmic%20beauty%20of%20plants/image-20220710142546975.png)

![image-20220710142556842](The%20algorithmic%20beauty%20of%20plants/image-20220710142556842.png)

上面的例子表明，本田的树形模型，以及青野和国井研究的衍生物 以及由Aono和Kunii研究的它们的衍生物，都可以用L系统的形式主义来表达 用L-系统的形式主义来表达。在一项单独的研究中，Shebell[130]也 在另一项研究中，Shebell[130]也表明，L-系统可用于生成Hall ́e、Old ́e和Kunii的架构树 Hall ́e、Oldeman和Tomlinson[58]的模型。这些结果表明 这些结果表明，L-系统可以作为一种工具，在生物学上发挥重要作用。 正确地模拟树木的发展和合成真实的树木图像的重要作用。图像。然而，到目前为止，创建的树状图形是相当通用的 (图2.11），而直接基于生物数据的特定树种的模型还有待开发。迄今为止，所创建的树形是相当通用的（图2.11），而直接基于生物数据的特定树种模型还有待开发。L-系统已经发现了更多 在草木植物的现实建模领域有更多的应用。下一章将讨论。